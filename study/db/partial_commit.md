# 파샬 커밋(Partial Commit) - 분산 데이터베이스

### 정의
- 트랜잭션이 데이터베이스의 여러 부분에 걸쳐 실행될 때 발상하는 상황
- 분산 데이터베이스는 여러 컴퓨터(또는 노드)에 걸쳐 데이터를 저장하고 관리하는 시스템
- 하나의 트랜잭션은 여러 노드에 걸쳐 실행될 수 있으며, 각 노드는 자신의 부분적인 커밋(파샬 커밋)을 수행할 수 있습니다.

### 개념
- **파샬 커밋 상황 :**
  - 트랜잭션이 분산 데이터베이스 시스템의 여러 노드에 걸쳐 실행될 때, 모든 노드가 트랜잭션을 성공적으로 완료하고 커밋할 수 없는 경우에 발생
  - 일부 노드는 트랜잭션을 커밋할 수 있지만, 다른 노드는 실패할 수 있음
- **문제점 :**
  - 일부 노드에서는 트랜잭션이 성공적으로 커밋되어 변경사항이 적용되지만, 다른 노드에서는 실패하여 변경사항이 롤백되는 등 데이터의 일관성을 유지하기 어렵다
- **해결책 :**
  - 분산 데이터베이스 시스템은 종종 2단계 커밋 프로토콜(2PC)과 같은 트랜잭션 관리 프로토콜을 사용한다
  - **2PC는 모든 노드에서 트랜잭션이 성공적으로 커밋될 때까지 기다리는 과정을 포함하여, 하나의 노드라도 커밋할 수 없는 경우 모든 노드에서 트랜잭션을 롤백하여 데이터의 일관성을 유지한다.**

### 2단계 커밋 프로토콜(2PC)
1. **준비 단계 :** 
  - 트랜잭션 매니저가 모든 참여 노드에게 트랜잭션 커밋 준비를 요청한다
2. **투표 단계 :**
  -  각 노드는 트랜잭션을 성공적으로 커밋할 수 있는지 여부를 트랜잭션 매니저에게 응답한다.
3. **커밋/롤백 단계 :**
  - 모든 노드가 커밋할 준비가 되었다고 응답하면, 트랜잭션 매니저는 모든 노드에 커밋 명령을 보낸다
  - 하나라도 커밋할 수 없다고 응답하는 경우, 모든 노드에 롤백 명령을 보낸다.

### 결론
- 파샬 커밋은 분산 데이터베이스 시스템에서 발생할 수 있는 중요한 문제
- 이를 해결하기 위해 2단계 커밋 프로토콜(2PC)은 데이터의 일관성과 무결성을 유지하는데 중요한 역할을 한다.
- 2PC는 통신 오버헤드와 성능 저하를 초래할 수 있으며, 따라서 설계와 구현 단계에서 세심한 고려가 필요한다.

